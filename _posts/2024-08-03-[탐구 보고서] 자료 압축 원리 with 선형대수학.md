---
layout: post
title:  "[탐구 보고서] 자료압축원리 with 선형대수학"
tagline: 선형대수학 자료압축원리
author: MovingJu
categories: [탐구 보고서]
image: assets/images/posts/[탐구 보고서] 자료압축원리 with 선형대수학.png
lastmode: 2024-07-12 12:00:00
sitemap:
  changefreq: daily
  priority : 1.0
use_math: true
---

축소된 특이값 분해와 자료압축원리

# 도입

![Screenshot from 2024-08-04 15-53-00](https://github.com/user-attachments/assets/57d4485d-1f74-48a2-959b-46ddd8379b0b)

유튜브에서 화질 선택을 한번쯤 해본 경험이 있을 것이다.

이건 어떻게 작동하는 것이고 왜 화질을 낮추면 로딩 속도가 빨라지는 걸까?

선형대수학의 자료 압축 원리를 통해 알아보자

# 배경지식

## 기본

[이전 포스팅](https://movingju.github.io/%ED%83%90%EA%B5%AC-%EB%B3%B4%EA%B3%A0%EC%84%9C-%EC%A3%BC%EC%B6%95%EC%A0%95%EB%A6%AC%EB%A1%9C-%EA%B8%B0%ED%95%98%EC%9D%98-%EC%9D%B4%EC%B0%A8%EA%B3%A1%EC%84%A0-%EC%8B%AC%ED%99%94%ED%95%98%EA%B8%B0/#%EB%B0%B0%EA%B2%BD%EC%A7%80%EC%8B%9D) 참고

## 고윳값 분해

$$
n*n
$$
행렬에 대해 다음 조건을 만족하는 행렬이 가능하다.

$$
n개의 \,선형독립인 \,고유벡터를 \,가진다 \\ \Updownarrow \\
대각화 \,가능하다.
$$

이러한 행렬 $$A$$에 대해

$$
D = P^{-1}AP
$$

를 **대각화** 혹은 **고윳값 분해**라 한다.

이때 행렬$$D$$는 대각행렬로 $$A$$의 고윳값들을 크기순으로 나열한 것과 같고, 행렬$$P$$는 각각의 고윳값들을 크기순으로 열벡터로 나열한 벡터이다.

예를 들어 $$A = \begin{pmatrix}
2 &  1\\
 1&  2\\
\end{pmatrix}$$ 라 하면, $$A$$의 고윳값은 3, -1이고, 고유벡터는 각각 $$\begin{pmatrix}1 \\ 1\end{pmatrix}\begin{pmatrix} 3 \\ 1\end{pmatrix}$$ 이다.

이때의 $$D = \begin{pmatrix} 3 & 0 \\ 0 & 1 \end{pmatrix} \, \, P = \begin{pmatrix} 3 & 1 \\ 1 & -1 \end{pmatrix}$$ 이다.

이 고윳값 분해는 여러 계산상의 이점과 기하적 의미가 있는데 자세한 내용은 [해당 영상](https://www.youtube.com/watch?v=PP9VQXKvSCY) 참고

## 특잇값 분해

**특잇값 분해**는 고윳값 분해의 일반화된 버전이다.

임의의 $$m*n$$행렬 A에 대해 성립하며, 다음 형태를 말한다.

$$
A = U\Sigma V^T
$$

이때 $$U$$와 $$V$$는 Orthogonal Matrix ($$U^{T} = U^{-1}$$)이고, $$AA^{T},\,A^{T}A$$ 는 대칭행렬이다.

따라서 $$AA^{T}, \, A^{T}A$$는 전치대각화가 가능하므로 $$U, \, \Sigma,\, V$$의 값을 구할 수 있다.

$$
AA^T = U\Sigma V^T V \Sigma ^T U^T = U\Sigma \Sigma ^T U^T = Q\Lambda Q^T \\
A^TA = V\Sigma ^T U^T U \Sigma V^T = V \Sigma ^T \Sigma V^T = Q\Lambda Q^T
$$

이를 통해 $$\Sigma$$의 원소들은 행렬 $$A$$의 고윳값들에 제곱근을 씌워 내림차순으로 정리한 것임을 알 수 있다.

# 자료 압축 원리

여기서 자료라 함은 보통 **이미지 한장**을 말한다.

이미지 한장은 $$m*n$$로 나타낼 수 있으므로 항상 **특잇값 분해**가 가능하다!

이때 다음과 같은 축소된 특잇값 분해를 함으로써 이미지가 차지하는 메모리를 줄여 처리속도를 키울 수 있다.

![제목 없음](https://github.com/user-attachments/assets/628ab334-fefc-40e6-b5dc-e862ca4bddf5)

특히, 마지막 과정은 특잇값 중 가장 작은 값들을 줄이면서 이미지의 화질을 줄이지만, 처리할때 차지하는 용량을 매우 효과적으로 줄일 수 있다.

$ m*n $ 흑백 이미지에 대해, 컴퓨터에서 계산할 때 차지하는 양은 다음과 같다. (바이트 기준)

$$
이미지를 \,그대로 \,처리할 \,시: \,1 * m * n\\
SVD를\, 사용할\, 시:\, 4k(1+m+n)\, (단, k는\, 특잇값\, 벡터의\, 크기)
$$

이때 $$k$$값 앞에 4가 붙는 이유는 자료 저장 방식 (float32) 때문이다.

아래의 왼쪽 이미지는 실제 SVD를 통해 특잇값 벡터를 $$\frac{1}{6}$$로 축소한 이미지이다.

<img src="https://github.com/user-attachments/assets/4928ef0d-912d-41e8-a128-99752052cf53" width="350" height="auto" alt="Image" style="display: inline-block; vertical-align: top;">
<img src="https://github.com/user-attachments/assets/08637b6d-33b7-43d3-86fb-d087441bbe94" width="350" height="auto" alt="Image" style="display: inline-block; vertical-align: top;">

계산량은 절반으로 줄었지만, 시각적으론 큰 차이가 없어보인다!

# 느낀점 

